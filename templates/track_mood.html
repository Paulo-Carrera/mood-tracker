{% extends "base.html" %}

{% block content %}
<h2>Track Your Mood</h2>
<form method="POST" action="/track_mood">
    <p>Select your mood(s):</p>
    
    <div id="bubble-container">
        {% for category, category_moods in categorized_moods.items() %}
        <div class="category-section">
            <!-- <h3>{{ category|capitalize }}</h3> -->
            <div class="category-bubbles">
                {% for mood in category_moods %}
                <div class="bubble {{ category }}" data-mood="{{ mood }}">
                    {{ mood }}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>

    <input type="hidden" id="selected-moods" name="mood" required>
    
    <label for="note">Notes (optional):</label>
    <textarea id="note" name="note" width="100%" height="100%"></textarea>
    
    <button type="submit">Submit</button>
</form>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const bubbles = document.querySelectorAll(".bubble");
        const selectedMoodsInput = document.getElementById("selected-moods");
        let selectedMoods = [];

        bubbles.forEach(bubble => {
            bubble.addEventListener("click", () => {
                const mood = bubble.dataset.mood;

                if (selectedMoods.includes(mood)) {
                    // Deselect the mood
                    selectedMoods = selectedMoods.filter(m => m !== mood);
                    bubble.classList.remove("selected");
                } else {
                    // Select the mood
                    selectedMoods.push(mood);
                    bubble.classList.add("selected");
                }

                // Update the hidden input with selected moods
                selectedMoodsInput.value = selectedMoods.join(",");
            });
        });
    });
</script>

<style>
    #bubble-container {
        margin: 20px 0;
    }

    .category-section {
        margin-bottom: 30px;
    }

    .category-section h3 {
        text-align: center;
        margin-bottom: 10px;
    }

    .category-bubbles {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
    }

    .bubble {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100px;
        height: 100px;
        border-radius: 50%;
        color: white;
        font-weight: bold;
        cursor: pointer;
        animation: float 4s infinite ease-in-out;
        position: relative;
        transition: transform 0.2s, background 0.2s;
    }

    .bubble:hover {
        transform: scale(1.1);
    }

    .bubble.selected {
        background: grey;
        outline: 4px solid white;
        transform: scale(1.1);
    }

    /* Define colors for mood categories */
    .positive {
        background: radial-gradient(circle, #a3ffb0, #53c253); /* Green */
    }

    .negative {
        background: radial-gradient(circle, #ffaaaa, #d44b4b); /* Red */
    }

    .neutral {
        background: radial-gradient(circle, #ffd480, #e6a300); /* Yellow */
    }

    .high-energy {
        background: radial-gradient(circle, #80bfff, #0066cc); /* Blue */
    }

    .low-energy {
        background: radial-gradient(circle, #d6aaff, #8a2be2); /* Purple */
    }

    @keyframes float {
        0% { transform: translateY(0); }
        50% { transform: translateY(-20px); }
        100% { transform: translateY(0); }
    }
</style>
{% endblock %}
